<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
<meta data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta data-key="format-detection" name="format-detection" content="telephone=no">
<meta name="mobile-web-app-capable" content="yes">


<title>Pedro Carmona: Personal Website</title>
<meta name="title" content="Pedro Carmona" />
<meta name="keywords" content="Pedro, Carmona, Ruby, Rails, Portugal, Netherland" />
<meta name="description" content="Personal website - Software Engineer - Portuguese." />
<meta name="author" content="Pedro Carmona" />

<link rel="stylesheet" href="/assets/css/main.css">

<noscript>
<style>.g-image--loading{display:none;}</style>
</noscript>


<link rel="shortcut icon" href="/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png">
<link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="167x167" href="/favicons/apple-touch-icon-167x167.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
<link rel="apple-touch-icon" sizes="1024x1024" href="/favicons/apple-touch-icon-1024x1024.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="new-bridgetown-site">
<link rel="apple-touch-startup-image"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-640x1136.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-750x1334.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-828x1792.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-1125x2436.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-1242x2208.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-1242x2688.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-1536x2048.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-1668x2224.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-1668x2388.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-2048x2732.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="/favicons/apple-touch-startup-image-1620x2160.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-1136x640.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-1334x750.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-1792x828.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2436x1125.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2208x1242.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2688x1242.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2048x1536.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2224x1668.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2388x1668.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2732x2048.png">
<link rel="apple-touch-startup-image"
      media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="/favicons/apple-touch-startup-image-2160x1620.png">
<link rel="icon" type="image/png" sizes="228x228" href="/favicons/coast-228x228.png">
<meta name="msapplication-TileColor" content="#fff">
<meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">
<meta name="msapplication-config" content="/favicons/browserconfig.xml">
  </head>


  <body>
    <div class="flex flex-col min-h-screen">
       <!-- Header with Navbar -->
 <header class="border-t-4 border-primary">
  <nav class="navbar bg-base-100">
    <div class="navbar-start">
      <div class="dropdown">
        <div tabindex="0" role="button" class="btn btn-ghost lg:hidden">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
          </svg>
        </div>
        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52">
          <li><a href="/blog">Blog</a></li>
          <li><a href="/assets/pdfs/pedro-carmona-cv.pdf">CV</a></li>
        </ul>
      </div>
      <a href="/" class="flex items-center">
        <div class="avatar">
          <div class="w-10 h-10 rounded-full">
            <img src="/assets/img/picture.jpeg" alt="Pedro Carmona" />
          </div>
        </div>
        <span class="ml-4 text-lg font-bold uppercase">Pedro Carmona</span>
      </a>
    </div>
    <div class="navbar-end hidden lg:flex">
      <ul class="menu menu-horizontal px-1 font-bold uppercase">
        <li><a href="/blog">Blog</a></li>
        <li><a href="/assets/pdfs/pedro-carmona-cv.pdf">CV</a></li>
      </ul>
    </div>
  </nav>
</header>
      <!-- Main Content -->
      <main class="flex-grow">
        <div class="container mx-auto px-6 py-16">
          <div class="max-w-2xl mx-auto mb-10">
            <div class="container mx-auto px-6 py-16">
              <p class="text-gray-600 text-sm font-light">February 13, 2019</p>
              <h1 class="text-gray-800 text-xl sm:text-2xl md:text-3xl font-bold capitalize mt-2">Add sentry to your airflow</h1>

              <div class="prose md:prose-2xl">
                  <p>Since this <a href="https://github.com/apache/airflow/pull/2135">pull request</a> in airflow github repository, it is possible to send errors to sentry. This way you get a sentry alert every time an error or a SIGTERM happens.</p>

<p>My configuration</p>

<p>dags/notify_sentry.py</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import os
import sentry_sdk
from sentry_sdk import capture_exception, configure_scope
# requires sentry-sdk==0.7.0


def sentry_capture_exception(context):
    """
        Sends Error to Sentry.
        op = BashOperator(
            dag=my_dag,
            task_id='my_task',
            python_callable=my_python_job,
            on_failure_callback=sentry_capture_exception
        )
    """
    dsn = os.getenv('SENTRY_DSN')
    sentry_sdk.init(dsn)
    error = context.get('exception')

    with configure_scope() as scope:
        scope.set_extra('dag', context.get('dag'))
        scope.set_extra('dag_run', context.get('dag_run'))
        scope.set_extra('ds', context.get('ds'))
        scope.set_extra('end_date', context.get('end_date'))
        scope.set_extra('execution_date', context.get('execution_date'))
        scope.set_extra('latest_date', context.get('latest_date'))
        scope.set_extra('params', context.get('params'))
        scope.set_extra('run_id', context.get('run_id'))
        scope.set_extra('task', context.get('task'))
        scope.set_extra('task_instance', context.get('task_instance'))
        scope.set_extra('ti', context.get('ti'))
        scope.set_extra('ts', context.get('ts'))
        scope.set_extra('yesterday_ds', context.get('yesterday_ds'))

    capture_exception(error)
</code></pre></div></div>

<p>then in your dag:</p>

<p>dags/my_dag.py</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from notify_sentry import sentry_capture_exception

...


op = BashOperator(
    dag=my_dag,
    task_id='my_task',
    python_callable=my_python_job,
    on_failure_callback=sentry_capture_exception
)

</code></pre></div></div>

<p>Sometimes, you might need to add <code class="language-plaintext highlighter-rouge">provide_context=True</code> to the operator parameters.</p>

              </div>
            </div>
          </div>
      </main>
    </div>
    <footer class="footer footer-horizontal footer-center bg-base-200 text-base-content rounded p-10">
  <aside>
    <p>Copyright Â© 2025 - All right reserved by ACME Industries Ltd</p>
  </aside>
</footer>
  </body>
</html>
